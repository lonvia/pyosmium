name: CI

on: [ push, pull_request ]

jobs:
    build-default:
        runs-on: ubuntu-18.04

        strategy:
            matrix:
                python-version: [3.5, 3.6, 3.7, 3.8, 3.9]

        steps:
            - uses: actions/checkout@v2

            - name: Set up Python ${{ matrix.python-version }}
              uses: actions/setup-python@v2
              with:
                  python-version: ${{ matrix.python-version }}

            - name: Install packages
              run: sudo apt-get install -y -qq libboost-dev libexpat1-dev zlib1g-dev libbz2-dev libproj-dev

            - uses: ./.github/actions/install-dependencies

            - name: Build package
              run: python3 setup.py build
              shell: bash

            - name: Run tests
              run: python3 run_tests.py
              shell: bash
              working-directory: test
